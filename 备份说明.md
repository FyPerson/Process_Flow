# 项目备份说明

## 最新备份信息

**备份时间**: 2025-12-18 14:13  
**备份版本**: 分组功能完全修复版  
**备份位置**: `E:\业务全景图_google\backup_stable_20251218_141310`  
**压缩备份**: `E:\业务全景图_google\backup_stable_20251218_141310.zip`  
**备份大小**: 约 0.2 MB

## 本次备份的功能状态

### ✅ 完全正常的功能
- **分组创建**：选中节点创建分组，节点正确显示在分组内
- **分组调整大小**：拖动调整手柄，尺寸正确保存和恢复
- **分组移动**：移动分组，子节点跟随移动
- **节点移动**：移动分组内的节点，位置正确保存
- **自动保存**：2秒后自动保存到 localStorage
- **数据持久化**：刷新页面后，所有变化正确恢复
- **分组解散**：正常工作
- **撤销/重做**：正常工作

### 🔧 关键修复
1. **extent 设置**：使用 `'parent'` 字符串而不是坐标数组
2. **extent useEffect**：跳过已设置为 `'parent'` 的节点
3. **尺寸保存**：优先使用 `measured.width/height`（调整后的实际尺寸）
4. **尺寸加载**：优先使用 `size` 中的尺寸而不是 `style`
5. **自动保存延迟**：设置为 2 秒

### ⚠️ 已知问题
- **ResizeObserver 警告**：控制台会显示无害的浏览器警告，不影响功能

## 备份内容

已备份以下关键文件和目录：
- ✅ `src/` - 所有源代码
- ✅ `public/` - 静态资源
- ✅ `index.html` - 入口文件
- ✅ `package.json` - 依赖配置
- ✅ `package-lock.json` - 锁定依赖版本
- ✅ `tsconfig.json` - TypeScript 配置
- ✅ `vite.config.ts` - Vite 配置
- ✅ `README.md` - 项目说明

**未备份**：`node_modules/`（可通过 `npm install` 重新安装）

## 如何恢复备份

### 方法 1：从 ZIP 恢复
```powershell
# 1. 解压 ZIP 文件
Expand-Archive "backup_stable_20251218_141310.zip" -DestinationPath "恢复目录"

# 2. 进入恢复的目录
cd 恢复目录\backup_stable_20251218_141310

# 3. 重新安装依赖
npm install

# 4. 运行项目
npm run dev
```

### 方法 2：从文件夹恢复
```powershell
# 1. 复制备份文件夹
Copy-Item "backup_stable_20251218_141310" "恢复目录" -Recurse

# 2. 进入恢复的目录
cd 恢复目录

# 3. 重新安装依赖
npm install

# 4. 运行项目
npm run dev
```

## 创建新备份的命令

```powershell
# 在项目根目录执行
$timestamp = Get-Date -Format "yyyyMMdd_HHmmss"
$backupName = "backup_stable_$timestamp"

# 创建备份文件夹
New-Item -ItemType Directory -Path $backupName -Force | Out-Null
Copy-Item -Path "src", "public", "index.html", "package.json", "package-lock.json", "tsconfig.json", "vite.config.ts", "README.md" -Destination $backupName -Recurse -Force

# 创建压缩备份
Compress-Archive -Path $backupName -DestinationPath "$backupName.zip" -Force

Write-Host "✅ 备份已创建: $backupName.zip"
```

## 备份策略建议

### 定期备份
建议在以下情况创建备份：
1. 完成重要功能后（如本次分组功能修复）
2. 开始重大重构前
3. 每周定期备份

### 备份文件管理
- 保留最近 3-5 个备份
- 将重要的里程碑备份移动到安全位置（如外部硬盘或云存储）
- 定期清理旧备份以节省空间

## 版本历史

### v2 - 2025-12-18 14:13（当前版本）
- ✅ 分组功能完全修复
- ✅ 自动保存优化（2秒延迟）
- ✅ 数据持久化正常

### v1 - 2025-12-18 13:45
- ✅ 分组创建基本功能
- ⚠️ 调整大小后刷新不保存（已在 v2 修复）
